
ktml.prototype.detectWordsArray=function(){var sel=this.edit.selection;if(sel.type=="None"||is.mozilla&&(sel.isCollapsed||sel.focusNode.nodeName=="BR"||sel.focusNode.childNodes[sel.focusOffset]&&sel.focusNode.childNodes[sel.focusOffset].nodeName=="BR")){this.logic_doFormat('SelectAll');var rng=sel.createRange();}else if(sel.type=="Control"){var rng=sel.createRange();if(is.ie){var startElement=rng(0);rng=this.edit.body.createTextRange();rng.moveToElementText(startElement);rng.select();}}else{var rng=sel.createRange();}
var txt='';txt=rng.htmlText;txt=txt.replace(/></gi,'> <');txt=txt.replace(/<(?:style|script)[^>]*>/gi,'<!--');txt=txt.replace(/<\/?(?:style|script)>/gi,'-->');txt=txt.replace(/<\/?[\w:]+(?:\s|\/)?.*?>/gi," ");txt=utility.string.getInnerText(txt);txt=txt.replace(/[\s,\?!;\.\[\]\-']/gi,' ');var sword_array=txt.split(/\s/);var word_array=[];for(var i=0;i<sword_array.length;i++){if(sword_array[i].length>1){word_array.push(sword_array[i]);}}
this.setModuleProperty("spellchecker","word_array",word_array);this.setModuleProperty("spellchecker","selectionRange",rng);};ktml.prototype.openSpellChecker=function(){if(!this.hasModuleProperty("spellchecker","languages")){this.setModuleProperty('spellchecker','languages',[]);}
this.cw.focus();this.detectWordsArray();if(this.getModuleProperty("spellchecker","word_array").length){var wnd=utility.window.openWindow("SpellCheckWindow"+parseInt(Math.random()*1000000000),KtmlRoot+"modules/spellchecker/spellchecker.html?id="+this.counter,370,295);}};function spellchecker_runonce(){}
function spellchecker_runeach(k){var cmd="this.ktml.openSpellChecker()";var idx=k.toolbar.indexOfName('spellcheck');if(idx>=0){k.toolbar.buttonobjects[idx].command=cmd;}else{k.toolbar.deferredcommands['spellcheck']=cmd;}}